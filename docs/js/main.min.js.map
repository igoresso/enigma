{"version":3,"names":[],"mappings":"","sources":["main.min.js"],"sourcesContent":["(function(){\"use strict\";const e=[\"A\",\"B\",\"C\",\"D\",\"E\",\"F\",\"G\",\"H\",\"I\",\"J\",\"K\",\"L\",\"M\",\"N\",\"O\",\"P\",\"Q\",\"R\",\"S\",\"T\",\"U\",\"V\",\"W\",\"X\",\"Y\",\"Z\"],t=[\"Q\",\"W\",\"E\",\"R\",\"T\",\"Z\",\"U\",\"I\",\"O\",\"A\",\"S\",\"D\",\"F\",\"G\",\"H\",\"J\",\"K\",\"P\",\"Y\",\"X\",\"C\",\"V\",\"B\",\"N\",\"M\",\"L\"],n={I:{alphabet:[\"E\",\"K\",\"M\",\"F\",\"L\",\"G\",\"D\",\"Q\",\"V\",\"Z\",\"N\",\"T\",\"O\",\"W\",\"Y\",\"H\",\"X\",\"U\",\"S\",\"P\",\"A\",\"I\",\"B\",\"R\",\"C\",\"J\"],notch:\"Q\"},II:{alphabet:[\"A\",\"J\",\"D\",\"K\",\"S\",\"I\",\"R\",\"U\",\"X\",\"B\",\"L\",\"H\",\"W\",\"T\",\"M\",\"C\",\"Q\",\"G\",\"Z\",\"N\",\"P\",\"Y\",\"F\",\"V\",\"O\",\"E\"],notch:\"E\"},III:{alphabet:[\"B\",\"D\",\"F\",\"H\",\"J\",\"L\",\"C\",\"P\",\"R\",\"T\",\"X\",\"V\",\"Z\",\"N\",\"Y\",\"E\",\"I\",\"W\",\"G\",\"A\",\"K\",\"M\",\"U\",\"S\",\"Q\",\"O\"],notch:\"V\"},IV:{alphabet:[\"E\",\"S\",\"O\",\"V\",\"P\",\"Z\",\"J\",\"A\",\"Y\",\"Q\",\"U\",\"I\",\"R\",\"H\",\"X\",\"L\",\"N\",\"F\",\"T\",\"G\",\"K\",\"D\",\"C\",\"M\",\"W\",\"B\"],notch:\"J\"},V:{alphabet:[\"V\",\"Z\",\"B\",\"R\",\"G\",\"I\",\"T\",\"Y\",\"U\",\"P\",\"S\",\"D\",\"N\",\"H\",\"L\",\"X\",\"A\",\"W\",\"M\",\"J\",\"Q\",\"O\",\"F\",\"E\",\"C\",\"K\"],notch:\"Z\"}},o={A:[\"E\",\"J\",\"M\",\"Z\",\"A\",\"L\",\"Y\",\"X\",\"V\",\"B\",\"W\",\"F\",\"C\",\"R\",\"Q\",\"U\",\"O\",\"N\",\"T\",\"S\",\"P\",\"I\",\"K\",\"H\",\"G\",\"D\"],B:[\"Y\",\"R\",\"U\",\"H\",\"Q\",\"S\",\"L\",\"D\",\"P\",\"X\",\"N\",\"G\",\"O\",\"K\",\"M\",\"I\",\"E\",\"B\",\"F\",\"Z\",\"C\",\"W\",\"V\",\"J\",\"A\",\"T\"],C:[\"F\",\"V\",\"P\",\"J\",\"I\",\"A\",\"O\",\"Y\",\"E\",\"D\",\"R\",\"Z\",\"X\",\"W\",\"G\",\"C\",\"T\",\"K\",\"U\",\"Q\",\"S\",\"B\",\"N\",\"M\",\"H\",\"L\"]};const l=new class{constructor(e){this.rotors=Array.from(document.querySelectorAll(e)).reverse(),this.valueIndex=[]}setValue(t,n){const o=this.rotors[t],l=e.indexOf(n),r=o.querySelector(\".rotors__window--active\"),a=r.previousElementSibling,s=a.previousElementSibling,i=r.nextElementSibling,u=i.nextElementSibling,c=o.querySelector(\".rotors__wheel\"),d=25<l+1?0:l+1,p=25<l+2?l-26+2:l+2,I=0>l-1?25:l-1,g=0>l-2?l+26-2:l-2;r.value=e[l],a.innerText=e[d],s.innerText=e[p],i.innerText=e[I],u.innerText=e[g],c.style.backgroundPositionY=7*(100*l/26)+\"%\",this.valueIndex[t]=l}stepRotor(t){const n=25<this.valueIndex[t]+1?0:this.valueIndex[t]+1,o=e[n];this.setValue(t,o)}getCurrentState(){return this.valueIndex}bind(){for(let[t,n]of this.rotors.entries()){const o=n.querySelector(\".rotors__btn--next\"),l=n.querySelector(\".rotors__btn--prev\"),r=n.querySelector(\"input\");o.onclick=()=>{const n=this.valueIndex[t],o=25<n+1?0:n+1;this.setValue(t,e[o])},l.onclick=()=>{const n=this.valueIndex[t],o=0>n-1?25:n-1;this.setValue(t,e[o])},r.onkeypress=t=>{t.stopPropagation()},r.onchange=()=>{r.validity.valid&&0<r.value.length?(r.value=r.value.toUpperCase(),this.setValue(t,r.value)):this.setValue(t,e[this.valueIndex[t]])}}}reset(){for(let e=0;e<this.rotors.length;e++)this.setValue(e,\"A\")}init(){this.reset(),this.bind()}}(\".rotors__item\");const r=new class{constructor(e){this.lamps=document.querySelectorAll(e),this.lastIndex=null}newOutput(e){const n=t.indexOf(e);this.reset(),this.lamps[n].classList.add(\"lampboard__lamp--active\"),this.lastIndex=n}reset(){const e=this.lastIndex||0;this.lamps[e].classList.remove(\"lampboard__lamp--active\"),this.lastIndex=null}}(\".lampboard__lamp\");const a=new class{constructor(e){this.keys=document.querySelectorAll(e)}inputAction(e){return e}bind(){for(let e of this.keys){const t=e.innerText.toUpperCase();e.onclick=()=>{this.inputAction(t)}}document.onkeydown=t=>{const e=t.key.toUpperCase();/^[A-Z]{1}/.test(e)&&this.inputAction(e)}}init(){this.bind()}}(\".keyboard__btn\");const s=new class{constructor(e){this.sockets=document.querySelectorAll(e),this.connections={},this.prevSocket=null}createPlug(e){const t=document.createElement(\"div\");return t.classList.add(\"plugboard__plug\"),t.tabIndex=0,t.setAttribute(\"role\",\"button\"),t.innerText=e.toUpperCase(),t}disconnectSockets(e,t,n,o){e.remove(),t.remove(),delete this.connections[n],delete this.connections[o]}connectSockets(e,t){const n=t.querySelector(\"span\").innerText,o=e.querySelector(\"span\").innerText,l=this.createPlug(n),r=this.createPlug(o);l.onclick=t=>{t.stopPropagation(),this.disconnectSockets(l,r,n,o)},r.onclick=t=>{t.stopPropagation(),this.disconnectSockets(l,r,n,o)},e.appendChild(l),t.appendChild(r),this.connections[n]=o,this.connections[o]=n}reset(){for(let e of this.sockets){const t=e.querySelector(\".plugboard__plug\");t&&t.remove()}this.connections={}}bind(){for(let e of this.sockets)e.onclick=()=>{this.prevSocket&&this.prevSocket!==e?(this.connectSockets(e,this.prevSocket),e.blur(),this.prevSocket=null):this.prevSocket=e}}init(){this.bind()}}(\".plugboard__socket\");const i=new class{constructor(e,t,n){this.dialogueClass=e,this.toggleClass=t,this.selectClass=n}changeRotor(e,t){return[e,t]}changeReflector(e){return e}createOption(e){const t=document.createElement(\"option\");return t.value=e,t.innerText=e,t}bind(){const e=document.querySelector(`.${this.dialogueClass}`),t=document.querySelector(`.${this.toggleClass}`),l=Array.from(document.querySelectorAll(`.${this.selectClass}`)),r=Object.keys(o),a=Object.keys(n);t.onclick=()=>{t.classList.toggle(`${this.toggleClass}--active`),e.classList.toggle(`${this.dialogueClass}--active`)},r.forEach(e=>{l[0].appendChild(this.createOption(e))}),l[0].onchange=()=>{this.changeReflector(l[0].value),l[0].blur()};for(let e=1;e<l.length;e++)a.forEach(t=>{l[e].appendChild(this.createOption(t))}),l[e].onchange=()=>{this.changeRotor(3-e,l[e].value),l[e].blur()}}init(){this.bind(),this.reset()}reset(){const e=Array.from(document.querySelectorAll(`.${this.selectClass}`));e[0].value=\"B\",e[1].value=\"I\",e[2].value=\"II\",e[3].value=\"III\"}}(\"settings__dialogue\",\"settings__toggle\",\"settings__select\");const u=new class{constructor(e,t,n,o,l,r,a,s){this.modalClass=e,this.toggleClass=t,this.dateID=n,this.timeID=o,this.inputClass=l,this.checkboxID=r,this.submitClass=a,this.outputClass=s,this.month=[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"]}setTime(){const e=document.getElementById(this.dateID),t=document.getElementById(this.timeID);let n=new Date,o=n.getDate(),l=n.getMonth(),r=n.getFullYear(),a=n.getHours(),s=n.getMinutes();e.innerText=`${o} ${this.month[l]} ${r}`,10>o&&(o=\"0\"+o),l+=1,10>l&&(l=\"0\"+l),e.dateTime=`${r}-${l}-${o}`,t.innerText=`${a}:${s}`,t.dateTime=`${a}:${s}`}encryptText(e){return e}bind(){const e=document.querySelector(`.${this.modalClass}`),t=document.querySelector(`.${this.toggleClass}`),n=e.querySelector(`.${this.modalClass}__content`),o=document.querySelector(`.${this.inputClass}`),l=document.getElementById(this.checkboxID),r=document.querySelector(`.${this.submitClass}`),a=document.querySelector(`.${this.outputClass}`);t.onclick=()=>{e.classList.add(`${this.modalClass}--active`),this.setTime()},e.onclick=()=>{e.classList.remove(`${this.modalClass}--active`)},n.onclick=t=>{t.stopPropagation()},o.onkeyup=t=>{t.stopPropagation();o.value=o.value.replace(/[^A-Za-z\\s]/g,\"\"),o.value=o.value.toUpperCase()},r.onclick=()=>{let e=o.value;l.checked||(e=e.replace(/ /g,\"\").match(/.{1,5}/g).join(\" \")),a.innerText=this.encryptText(e)}}init(){this.bind()}}(\"modal\",\"modal__toggle\",\"date\",\"time\",\"message__input\",\"keep-formatting\",\"message__btn\",\"message__output\");const c=new class{constructor(){}sumValues(e,t){return 25<e+t?e-26+t:e+t}subValues(e,t){return 0>e-t?e+26-t:e-t}encrypt(t,n,o,l){let r;const a=e.indexOf(t),s=o.length;for(let u=0;u<s;u++)r=0==u?e.indexOf(n[u][this.sumValues(o[u],a)]):e.indexOf(n[u][this.sumValues(r,this.subValues(o[u],o[u-1]))]);r=n[s-1].indexOf(e[this.sumValues(e.indexOf(l[this.subValues(r,o[s-1])]),o[s-1])]);for(let a=s-1;0<=a;a--)r=0==a?this.subValues(r,o[0]):n[a-1].indexOf(e[this.subValues(r,this.subValues(o[a],o[a-1]))]);return r=e[r],r}};const d=new class{constructor(e,t,n){this.rotorSet=e,this.rotorSetNotch=t,this.reflector=n}init(){a.init(),s.init(),l.init(),i.init(),u.init();const e=document.querySelector(\".reset\");e.onclick=()=>{e.disabled=!0,e.style.transitionDuration=\"0.5s\",e.style.transform=\"rotate(360deg)\",this.reset(),setTimeout(()=>{e.disabled=!1,e.style.transitionDuration=\"0s\",e.style.transform=\"\"},500)}}reset(){l.reset(),r.reset(),s.reset()}changeRotor(e,t,n){this.rotorSet[n]=e,this.rotorSetNotch[n]=t}changeReflector(e){this.reflector=e}inputAction(t){t in s.connections&&(t=s.connections[t]);const n=[0];for(let o=0;o<this.rotorSet.length-1;o++){const t=e[l.valueIndex[o]];if(t==this.rotorSetNotch[o])n.push(o+1);else break}n.forEach(e=>{l.stepRotor(e)});let o=c.encrypt(t,this.rotorSet,l.valueIndex,this.reflector);return o in s.connections&&(o=s.connections[o]),r.newOutput(o),o}}([n.III.alphabet,n.II.alphabet,n.I.alphabet],[n.III.notch,n.II.notch,n.I.notch],o.B);d.init(),a.inputAction=e=>{d.inputAction(e)},i.changeReflector=e=>{d.reflector=o[e],d.reset()},i.changeRotor=(e,t)=>{d.rotorSet[e]=n[t].alphabet,d.rotorSetNotch[e]=n[t].notch,d.reset()},u.encryptText=e=>{let t=\"\";for(let n=0;n<e.length;n++)t+=\" \"==e[n]?e[n]:d.inputAction(e[n]);return t}})();"],"file":"main.min.js"}